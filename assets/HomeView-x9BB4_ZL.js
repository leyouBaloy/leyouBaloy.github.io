import{u as le,N as re,a as ce}from"./Scrollbar-BxuZiwtO.js";import{P as de}from"./PageHead-DWUcoplo.js";import{d as ue,c as I,a as fe,b as F,u as ee,e as me,f as he,r as ve,g as U,N as ge,F as pe}from"./Foot-BziGG_do.js";import{f as we,i as be,L as xe,N as ye}from"./Image-CeSVjvE9.js";import{r as a,h as u,d as Y,w as _e,a as X,t as Ce,c as q,o as te,b as Le,T as ke,m as Se,n as ne,e as Te,f as m,g as h,i as v,j as w,k as Z,l as D,u as O,p as A,q as oe,_ as ae,F as G,s as J,v as Re}from"./app-ReEko8lC.js";import{u as Ee}from"./unwrap-element-CJbG4D_o.js";const Ne="/assets/loading-BpNIwhx0.gif";function Pe(e){return e.nodeType===9?null:e.parentNode}function se(e){if(e===null)return null;const n=Pe(e);if(n===null)return null;if(n.nodeType===9)return document.documentElement;if(n.nodeType===1){const{overflow:f,overflowX:i,overflowY:c}=getComputedStyle(n);if(/(auto|scroll|overlay)/.test(f+c+i))return n}return se(n)}const $e=a("0px");function K(e){return e.nodeName==="#document"}const ze={width:"44px",height:"44px",borderRadius:"22px",iconSize:"26px"};function He(e){const{popoverColor:n,textColor2:f,primaryColorHover:i,primaryColorPressed:c}=e;return Object.assign(Object.assign({},ze),{color:n,textColor:f,iconColor:f,iconColorHover:i,iconColorPressed:c,boxShadow:"0 2px 8px 0px rgba(0, 0, 0, .12)",boxShadowHover:"0 2px 12px 0px rgba(0, 0, 0, .18)",boxShadowPressed:"0 2px 12px 0px rgba(0, 0, 0, .18)"})}const Be={name:"BackTop",common:ue,self:He},Me=()=>u("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xlinkHref:"http://www.w3.org/1999/xlink"},u("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},u("g",{transform:"translate(-139.000000, -4423.000000)","fill-rule":"nonzero"},u("g",{transform:"translate(120.000000, 4285.000000)"},u("g",{transform:"translate(7.000000, 126.000000)"},u("g",{transform:"translate(24.000000, 24.000000) scale(1, -1) translate(-24.000000, -24.000000) translate(12.000000, 12.000000)"},u("g",{transform:"translate(4.000000, 2.000000)"},u("path",{d:"M8,0 C8.51283584,0 8.93550716,0.38604019 8.99327227,0.883378875 L9,1 L9,10.584 L12.2928932,7.29289322 C12.6834175,6.90236893 13.3165825,6.90236893 13.7071068,7.29289322 C14.0675907,7.65337718 14.0953203,8.22060824 13.7902954,8.61289944 L13.7071068,8.70710678 L8.70710678,13.7071068 L8.62544899,13.7803112 L8.618,13.784 L8.59530661,13.8036654 L8.4840621,13.8753288 L8.37133602,13.9287745 L8.22929083,13.9735893 L8.14346259,13.9897165 L8.03324678,13.9994506 L7.9137692,13.9962979 L7.77070917,13.9735893 L7.6583843,13.9401293 L7.57677845,13.9063266 L7.47929125,13.8540045 L7.4048407,13.8036865 L7.38131006,13.7856883 C7.35030318,13.7612383 7.32077858,13.7349921 7.29289322,13.7071068 L2.29289322,8.70710678 L2.20970461,8.61289944 C1.90467972,8.22060824 1.93240926,7.65337718 2.29289322,7.29289322 C2.65337718,6.93240926 3.22060824,6.90467972 3.61289944,7.20970461 L3.70710678,7.29289322 L7,10.585 L7,1 L7.00672773,0.883378875 C7.06449284,0.38604019 7.48716416,0 8,0 Z"}),u("path",{d:"M14.9333333,15.9994506 C15.5224371,15.9994506 16,16.4471659 16,16.9994506 C16,17.5122865 15.5882238,17.9349578 15.0577292,17.9927229 L14.9333333,17.9994506 L1.06666667,17.9994506 C0.477562934,17.9994506 0,17.5517354 0,16.9994506 C0,16.4866148 0.411776203,16.0639435 0.9422708,16.0061783 L1.06666667,15.9994506 L14.9333333,15.9994506 Z"})))))))),Ie=I("back-top",`
 position: fixed;
 right: 40px;
 bottom: 40px;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 height: var(--n-height);
 min-width: var(--n-width);
 box-shadow: var(--n-box-shadow);
 background-color: var(--n-color);
`,[we(),fe("transition-disabled",{transition:"none !important"}),I("base-icon",`
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 `),F("svg",{pointerEvents:"none"}),F("&:hover",{boxShadow:"var(--n-box-shadow-hover)"},[I("base-icon",{color:"var(--n-icon-color-hover)"})]),F("&:active",{boxShadow:"var(--n-box-shadow-pressed)"},[I("base-icon",{color:"var(--n-icon-color-pressed)"})])]),De=Object.assign(Object.assign({},ee.props),{show:{type:Boolean,default:void 0},right:{type:[Number,String],default:40},bottom:{type:[Number,String],default:40},to:{type:[String,Object],default:"body"},visibilityHeight:{type:Number,default:180},listenTo:[String,Object,Function],"onUpdate:show":{type:Function,default:()=>{}},target:Function,onShow:Function,onHide:Function}),je=Y({name:"BackTop",inheritAttrs:!1,props:De,setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:f}=me(e),i=a(null),c=a(!1);_e(()=>{const{value:d}=i;if(d===null){c.value=!1;return}c.value=d>=e.visibilityHeight});const l=a(!1);X(c,d=>{var r;l.value&&((r=e["onUpdate:show"])===null||r===void 0||r.call(e,d))});const b=Ce(e,"show"),x=le(b,c),L=a(!0),E=a(null),k=q(()=>({right:`calc(${U(e.right)} + ${$e.value})`,bottom:U(e.bottom)}));let g,N;X(x,d=>{var r,p;l.value&&(d&&((r=e.onShow)===null||r===void 0||r.call(e)),(p=e.onHide)===null||p===void 0||p.call(e))});const P=ee("BackTop","-back-top",Ie,Be,e,n);function C(){var d;if(N)return;N=!0;const r=((d=e.target)===null||d===void 0?void 0:d.call(e))||Ee(e.listenTo)||se(E.value);if(!r)return;g=r===document.documentElement?document:r;const{to:p}=e;typeof p=="string"&&document.querySelector(p),g.addEventListener("scroll",y),y()}function $(){(K(g)?document.documentElement:g).scrollTo({top:0,behavior:"smooth"})}function y(){i.value=(K(g)?document.documentElement:g).scrollTop,l.value||ne(()=>{l.value=!0})}function R(){L.value=!1}te(()=>{C(),L.value=x.value}),Le(()=>{g&&g.removeEventListener("scroll",y)});const z=q(()=>{const{self:{color:d,boxShadow:r,boxShadowHover:p,boxShadowPressed:H,iconColor:o,iconColorHover:s,iconColorPressed:t,width:S,height:T,iconSize:B,borderRadius:M,textColor:j},common:{cubicBezierEaseInOut:V}}=P.value;return{"--n-bezier":V,"--n-border-radius":M,"--n-height":T,"--n-width":S,"--n-box-shadow":r,"--n-box-shadow-hover":p,"--n-box-shadow-pressed":H,"--n-color":d,"--n-icon-size":B,"--n-icon-color":o,"--n-icon-color-hover":s,"--n-icon-color-pressed":t,"--n-text-color":j}}),_=f?he("back-top",void 0,z,e):void 0;return{placeholderRef:E,style:k,mergedShow:x,isMounted:be(),scrollElement:a(null),scrollTop:i,DomInfoReady:l,transitionDisabled:L,mergedClsPrefix:n,handleAfterEnter:R,handleScroll:y,handleClick:$,cssVars:f?void 0:z,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){const{mergedClsPrefix:e}=this;return u("div",{ref:"placeholderRef",class:`${e}-back-top-placeholder`,style:"display: none","aria-hidden":!0},u(xe,{to:this.to,show:this.mergedShow},{default:()=>u(ke,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterEnter:this.handleAfterEnter},{default:()=>{var n;return(n=this.onRender)===null||n===void 0||n.call(this),this.mergedShow?u("div",Se(this.$attrs,{class:[`${e}-back-top`,this.themeClass,this.transitionDisabled&&`${e}-back-top--transition-disabled`],style:[this.style,this.cssVars],onClick:this.handleClick}),ve(this.$slots.default,()=>[u(re,{clsPrefix:e},{default:Me})])):null}})}))}}),Ve={class:"wrapper"},Fe={class:"container"},We={key:0,class:"img-container"},Oe={class:"content"},Ae={class:"footer"},Ye={class:"time"},Ue={class:"tag"},Xe=Y({__name:"PostCard",props:{title:{type:String,default:"标题"},img:{type:String,default:""},content:{type:String,default:"内容"},time:{type:String,default:"2023-01-01"},tag:{type:String,default:"书影记录"},path:{type:String,default:"/"}},emits:["imageLoaded"],setup(e,{emit:n}){const f=n;function i(){f("imageLoaded")}return(c,l)=>{const b=Te("router-link");return m(),h("div",Ve,[v("div",Fe,[w(b,{to:e.path,class:"title"},{default:Z(()=>[v("span",null,D(e.title),1)]),_:1},8,["to"]),e.img?(m(),h("div",We,[w(O(ye),{lazy:"","object-fit":"cover",width:"100%",src:e.img,onLoad:i},null,8,["src"])])):A("",!0),v("div",Oe,[oe(D(e.content)+" ... ",1),w(b,{to:e.path,class:"more"},{default:Z(()=>l[0]||(l[0]=[v("span",null,"更多",-1)])),_:1},8,["to"])]),v("div",Ae,[v("span",Ye,"发布时间："+D(e.time),1),v("span",Ue,"分类："+D(e.tag),1)])])])}}}),Q=ae(Xe,[["__scopeId","data-v-c7fde0e0"]]),qe={class:"content"},Ze={key:0},Ge={class:"waterfall-card"},Je={class:"pagination-container"},Ke=["disabled"],Qe={key:0},et={key:0,src:Ne,style:{height:"100%"}},tt={key:1},nt={key:2},W=20,ot=Y({__name:"HomeView",setup(e){const n=a(!1),f=()=>{n.value=window.innerWidth<=500},i=a(1),c=a(1),l=a(!1),b=a([]),x=a(null),L=a(0),E=a(2),k=a(0),g=a(!0),N=a(!1),P=a(300),C=a([]),$=async()=>{try{l.value=!0;const o=await ce.get(`/markdown/metadata/metadata_${i.value}.json`);o.data.length&&(b.value.push(...o.data),o.data[0].totalPages&&(c.value=o.data[0].totalPages),await ne(),y())}catch(o){console.error("Error loading metadata:",o)}finally{l.value=!1}},y=async()=>new Promise(o=>{_();const s=[];if(x.value&&x.value.childNodes.forEach(t=>{t.className==="waterfall-item"&&s.push(t)}),!s.length)return!1;for(let t=0;t<s.length;t++){const S=s[t],T=S.style,B=Math.min(...C.value),M=C.value.indexOf(B),j=d(M);T.transform=`translate3d(${Math.floor(j)}px, ${Math.floor(B)}px, 0)`,T.width=`${k.value}px`,T.visibility="visible";const{height:V}=S.getBoundingClientRect();C.value[M]+=V,N.value||r(S,()=>{const ie=P.value/1e3;T.transition=`transform ${ie}s`})}L.value=Math.max(...C.value),setTimeout(()=>{o(!0)},P.value)});let R=null;function z(){R&&clearTimeout(R),R=setTimeout(()=>{y()},100)}const _=()=>{C.value=new Array(E.value).fill(g.value?W:0)},d=o=>{const s=g.value?o+1:o;return W*s+k.value*o};function r(o,s){const t=o.firstChild;t&&(t.classList.add("animate__animated","animate__fadeIn"),setTimeout(()=>{s()},300))}const p=async()=>{i.value<c.value&&!l.value&&(i.value++,await $())};function H(){const o=x.value;if(!o)return;const s=o.clientWidth;k.value=(s-3*W)/2,console.log("containerWidth:",s),console.log("colWidth:",k.value)}return te(()=>{f(),H(),window.addEventListener("resize",f),window.addEventListener("resize",H),window.addEventListener("resize",y),$()}),(o,s)=>(m(),h("main",null,[w(de),v("div",qe,[n.value?(m(),h("div",Ze,[(m(!0),h(G,null,J(b.value,t=>(m(),h("div",{key:t.title,class:"post-wrapper"},[w(Q,{title:t.title,content:t.excerpt,time:new Date(t.date).toLocaleDateString(),tag:t.tags?t.tags.join(", "):"未分类",img:t.img,path:`/post/${t.file}`,id:t.title},null,8,["title","content","time","tag","img","path","id"])]))),128))])):A("",!0),v("div",{class:"waterfall-container",ref_key:"waterfallWrapper",ref:x,style:Re({height:L.value+"px"})},[(m(!0),h(G,null,J(b.value,(t,S)=>(m(),h("div",{key:t.title,class:"waterfall-item"},[v("div",Ge,[w(Q,{title:t.title,content:t.excerpt,time:new Date(t.date).toLocaleDateString(),tag:t.tags?t.tags.join(", "):"未分类",img:t.img,path:`/post/${t.file}`,id:t.title,onImageLoaded:z},null,8,["title","content","time","tag","img","path","id"])])]))),128))],4),w(O(ge),{style:{"margin-bottom":"10px"}}),v("div",Je,[v("button",{class:"load-more-btn",onClick:p,disabled:l.value||i.value>=c.value},[l.value?(m(),h("span",Qe,[s[0]||(s[0]=oe("加载中...")),l.value?(m(),h("img",et)):A("",!0)])):i.value<c.value?(m(),h("span",tt,"加载更多")):(m(),h("span",nt,"没有更多内容"))],8,Ke)]),w(pe),w(O(je),{right:10,bottom:100})])]))}}),dt=ae(ot,[["__scopeId","data-v-ee6eb8dc"]]);export{dt as default};

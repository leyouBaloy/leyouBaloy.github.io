import{u as le,N as re,a as ce}from"./Scrollbar-iGTbWWPS.js";import{P as de}from"./PageHead-CRKKKL7o.js";import{d as ue,c as I,a as me,b as F,r as he,u as fe,f as Y,e as Q,g as ve,N as ge,F as pe}from"./Foot-De6Pr0IX.js";import{f as we,L as be,i as xe,N as ye}from"./Image-eE39wXKA.js";import{r as a,h as u,d as A,T as _e,m as Ce,w as Le,a as U,t as Se,c as X,o as ee,b as ke,n as te,e as Te,f as g,g as p,i as m,j as w,k as oe,l as q,p as D,u as O,q as ne,_ as ae,F as Z,s as G,v as Re,x as Ee}from"./app-DTDVP32g.js";import{u as Ne}from"./unwrap-element-CJbG4D_o.js";const Pe="/assets/loading-BpNIwhx0.gif";function $e(e){return e.nodeType===9?null:e.parentNode}function se(e){if(e===null)return null;const o=$e(e);if(o===null)return null;if(o.nodeType===9)return document.documentElement;if(o.nodeType===1){const{overflow:h,overflowX:i,overflowY:c}=getComputedStyle(o);if(/(auto|scroll|overlay)/.test(h+c+i))return o}return se(o)}const ze=a("0px");function J(e){return e.nodeName==="#document"}const He={width:"44px",height:"44px",borderRadius:"22px",iconSize:"26px"};function Me(e){const{popoverColor:o,textColor2:h,primaryColorHover:i,primaryColorPressed:c}=e;return Object.assign(Object.assign({},He),{color:o,textColor:h,iconColor:h,iconColorHover:i,iconColorPressed:c,boxShadow:"0 2px 8px 0px rgba(0, 0, 0, .12)",boxShadowHover:"0 2px 12px 0px rgba(0, 0, 0, .18)",boxShadowPressed:"0 2px 12px 0px rgba(0, 0, 0, .18)"})}const Be={common:ue,self:Me},Ie=()=>u("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xlinkHref:"http://www.w3.org/1999/xlink"},u("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},u("g",{transform:"translate(-139.000000, -4423.000000)","fill-rule":"nonzero"},u("g",{transform:"translate(120.000000, 4285.000000)"},u("g",{transform:"translate(7.000000, 126.000000)"},u("g",{transform:"translate(24.000000, 24.000000) scale(1, -1) translate(-24.000000, -24.000000) translate(12.000000, 12.000000)"},u("g",{transform:"translate(4.000000, 2.000000)"},u("path",{d:"M8,0 C8.51283584,0 8.93550716,0.38604019 8.99327227,0.883378875 L9,1 L9,10.584 L12.2928932,7.29289322 C12.6834175,6.90236893 13.3165825,6.90236893 13.7071068,7.29289322 C14.0675907,7.65337718 14.0953203,8.22060824 13.7902954,8.61289944 L13.7071068,8.70710678 L8.70710678,13.7071068 L8.62544899,13.7803112 L8.618,13.784 L8.59530661,13.8036654 L8.4840621,13.8753288 L8.37133602,13.9287745 L8.22929083,13.9735893 L8.14346259,13.9897165 L8.03324678,13.9994506 L7.9137692,13.9962979 L7.77070917,13.9735893 L7.6583843,13.9401293 L7.57677845,13.9063266 L7.47929125,13.8540045 L7.4048407,13.8036865 L7.38131006,13.7856883 C7.35030318,13.7612383 7.32077858,13.7349921 7.29289322,13.7071068 L2.29289322,8.70710678 L2.20970461,8.61289944 C1.90467972,8.22060824 1.93240926,7.65337718 2.29289322,7.29289322 C2.65337718,6.93240926 3.22060824,6.90467972 3.61289944,7.20970461 L3.70710678,7.29289322 L7,10.585 L7,1 L7.00672773,0.883378875 C7.06449284,0.38604019 7.48716416,0 8,0 Z"}),u("path",{d:"M14.9333333,15.9994506 C15.5224371,15.9994506 16,16.4471659 16,16.9994506 C16,17.5122865 15.5882238,17.9349578 15.0577292,17.9927229 L14.9333333,17.9994506 L1.06666667,17.9994506 C0.477562934,17.9994506 0,17.5517354 0,16.9994506 C0,16.4866148 0.411776203,16.0639435 0.9422708,16.0061783 L1.06666667,15.9994506 L14.9333333,15.9994506 Z"})))))))),De=I("back-top",`
 position: fixed;
 right: 40px;
 bottom: 40px;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 height: var(--n-height);
 min-width: var(--n-width);
 box-shadow: var(--n-box-shadow);
 background-color: var(--n-color);
`,[we(),me("transition-disabled",{transition:"none !important"}),I("base-icon",`
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 `),F("svg",{pointerEvents:"none"}),F("&:hover",{boxShadow:"var(--n-box-shadow-hover)"},[I("base-icon",{color:"var(--n-icon-color-hover)"})]),F("&:active",{boxShadow:"var(--n-box-shadow-pressed)"},[I("base-icon",{color:"var(--n-icon-color-pressed)"})])]),je=Object.assign(Object.assign({},Q.props),{show:{type:Boolean,default:void 0},right:{type:[Number,String],default:40},bottom:{type:[Number,String],default:40},to:{type:[String,Object],default:"body"},visibilityHeight:{type:Number,default:180},listenTo:[String,Object,Function],"onUpdate:show":{type:Function,default:()=>{}},target:Function,onShow:Function,onHide:Function}),Ve=A({name:"BackTop",inheritAttrs:!1,props:je,setup(e){const{mergedClsPrefixRef:o,inlineThemeDisabled:h}=fe(e),i=a(null),c=a(!1);Le(()=>{const{value:d}=i;if(d===null){c.value=!1;return}c.value=d>=e.visibilityHeight});const l=a(!1);U(c,d=>{var r;l.value&&((r=e["onUpdate:show"])===null||r===void 0||r.call(e,d))});const b=Se(e,"show"),x=le(b,c),L=a(!0),E=a(null),S=X(()=>({right:`calc(${Y(e.right)} + ${ze.value})`,bottom:Y(e.bottom)}));let f,N;U(x,d=>{var r,v;l.value&&(d&&((r=e.onShow)===null||r===void 0||r.call(e)),(v=e.onHide)===null||v===void 0||v.call(e))});const P=Q("BackTop","-back-top",De,Be,e,o);function C(){var d;if(N)return;N=!0;const r=((d=e.target)===null||d===void 0?void 0:d.call(e))||Ne(e.listenTo)||se(E.value);if(!r)return;f=r===document.documentElement?document:r;const{to:v}=e;typeof v=="string"&&document.querySelector(v),f.addEventListener("scroll",y),y()}function $(){(J(f)?document.documentElement:f).scrollTo({top:0,behavior:"smooth"})}function y(){i.value=(J(f)?document.documentElement:f).scrollTop,l.value||te(()=>{l.value=!0})}function R(){L.value=!1}ee(()=>{C(),L.value=x.value}),ke(()=>{f&&f.removeEventListener("scroll",y)});const z=X(()=>{const{self:{color:d,boxShadow:r,boxShadowHover:v,boxShadowPressed:H,iconColor:n,iconColorHover:s,iconColorPressed:t,width:k,height:T,iconSize:M,borderRadius:B,textColor:j},common:{cubicBezierEaseInOut:V}}=P.value;return{"--n-bezier":V,"--n-border-radius":B,"--n-height":T,"--n-width":k,"--n-box-shadow":r,"--n-box-shadow-hover":v,"--n-box-shadow-pressed":H,"--n-color":d,"--n-icon-size":M,"--n-icon-color":n,"--n-icon-color-hover":s,"--n-icon-color-pressed":t,"--n-text-color":j}}),_=h?ve("back-top",void 0,z,e):void 0;return{placeholderRef:E,style:S,mergedShow:x,isMounted:xe(),scrollElement:a(null),scrollTop:i,DomInfoReady:l,transitionDisabled:L,mergedClsPrefix:o,handleAfterEnter:R,handleScroll:y,handleClick:$,cssVars:h?void 0:z,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){const{mergedClsPrefix:e}=this;return u("div",{ref:"placeholderRef",class:`${e}-back-top-placeholder`,style:"display: none","aria-hidden":!0},u(be,{to:this.to,show:this.mergedShow},{default:()=>u(_e,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterEnter:this.handleAfterEnter},{default:()=>{var o;return(o=this.onRender)===null||o===void 0||o.call(this),this.mergedShow?u("div",Ce(this.$attrs,{class:[`${e}-back-top`,this.themeClass,this.transitionDisabled&&`${e}-back-top--transition-disabled`],style:[this.style,this.cssVars],onClick:this.handleClick}),he(this.$slots.default,()=>[u(re,{clsPrefix:e},{default:Ie})])):null}})}))}}),Fe={class:"wrapper"},We={class:"container"},Oe={key:0,class:"img-container"},Ae={class:"content"},Ye={class:"footer"},Ue={class:"time"},Xe={class:"tag"},qe=A({__name:"PostCard",props:{title:{type:String,default:"标题"},img:{type:String,default:""},content:{type:String,default:"内容"},time:{type:String,default:"2023-01-01"},tag:{type:String,default:"书影记录"},path:{type:String,default:"/"}},emits:["imageLoaded"],setup(e,{emit:o}){const h=o;function i(){h("imageLoaded")}return(c,l)=>{const b=Te("router-link");return p(),g("div",Fe,[m("div",We,[w(b,{to:e.path,class:"title"},{default:q(()=>[m("span",null,D(e.title),1)]),_:1},8,["to"]),e.img?(p(),g("div",Oe,[w(O(ye),{lazy:"","object-fit":"cover",width:"100%",src:e.img,onLoad:i},null,8,["src"])])):oe("",!0),m("div",Ae,[ne(D(e.content)+" ... ",1),w(b,{to:e.path,class:"more"},{default:q(()=>l[0]||(l[0]=[m("span",null,"更多",-1)])),_:1,__:[0]},8,["to"])]),m("div",Ye,[m("span",Ue,"发布时间："+D(e.time),1),m("span",Xe,"分类："+D(e.tag),1)])])])}}}),K=ae(qe,[["__scopeId","data-v-c7fde0e0"]]),Ze={class:"content"},Ge={key:0},Je={class:"waterfall-card"},Ke={class:"pagination-container"},Qe=["disabled"],et={key:0},tt={key:1},ot={key:2},W=20,nt=A({__name:"HomeView",setup(e){const o=a(!1),h=()=>{o.value=window.innerWidth<=500},i=a(1),c=a(1),l=a(!1),b=a([]),x=a(null),L=a(0),E=a(2),S=a(0),f=a(!0),N=a(!1),P=a(300),C=a([]),$=async()=>{try{l.value=!0;const n=await ce.get(`/markdown/metadata/metadata_${i.value}.json`);n.data.length&&(b.value.push(...n.data),n.data[0].totalPages&&(c.value=n.data[0].totalPages),await te(),y())}catch(n){console.error("Error loading metadata:",n)}finally{l.value=!1}},y=async()=>new Promise(n=>{_();const s=[];if(x.value&&x.value.childNodes.forEach(t=>{t.className==="waterfall-item"&&s.push(t)}),!s.length)return!1;for(let t=0;t<s.length;t++){const k=s[t],T=k.style,M=Math.min(...C.value),B=C.value.indexOf(M),j=d(B);T.transform=`translate3d(${Math.floor(j)}px, ${Math.floor(M)}px, 0)`,T.width=`${S.value}px`,T.visibility="visible";const{height:V}=k.getBoundingClientRect();C.value[B]+=V,N.value||r(k,()=>{const ie=P.value/1e3;T.transition=`transform ${ie}s`})}L.value=Math.max(...C.value),setTimeout(()=>{n(!0)},P.value)});let R=null;function z(){R&&clearTimeout(R),R=setTimeout(()=>{y()},100)}const _=()=>{C.value=new Array(E.value).fill(f.value?W:0)},d=n=>{const s=f.value?n+1:n;return W*s+S.value*n};function r(n,s){const t=n.firstChild;t&&(t.classList.add("animate__animated","animate__fadeIn"),s&&setTimeout(()=>{s()},300))}const v=async()=>{i.value<c.value&&!l.value&&(i.value++,await $())};function H(){const n=x.value;if(!n)return;const s=n.clientWidth;S.value=(s-3*W)/2,console.log("containerWidth:",s),console.log("colWidth:",S.value)}return ee(()=>{h(),H(),window.addEventListener("resize",h),window.addEventListener("resize",H),window.addEventListener("resize",y),$()}),(n,s)=>(p(),g("main",null,[w(de),m("div",Ze,[o.value?(p(),g("div",Ge,[(p(!0),g(Z,null,G(b.value,t=>(p(),g("div",{key:t.title,class:"post-wrapper"},[w(K,{title:t.title,content:t.excerpt,time:new Date(t.date).toLocaleDateString(),tag:t.tags?t.tags.join(", "):"未分类",img:t.img,path:`/post/${t.file}`,id:t.title},null,8,["title","content","time","tag","img","path","id"])]))),128))])):oe("",!0),m("div",{class:"waterfall-container",ref_key:"waterfallWrapper",ref:x,style:Re({height:L.value+"px"})},[(p(!0),g(Z,null,G(b.value,(t,k)=>(p(),g("div",{key:t.title,class:"waterfall-item"},[m("div",Je,[w(K,{title:t.title,content:t.excerpt,time:new Date(t.date).toLocaleDateString(),tag:t.tags?t.tags.join(", "):"未分类",img:t.img,path:`/post/${t.file}`,id:t.title,onImageLoaded:z},null,8,["title","content","time","tag","img","path","id"])])]))),128))],4),w(O(ge),{style:{"margin-bottom":"10px"}}),m("div",Ke,[m("button",{class:Ee(["load-more-btn",{"loading-btn":l.value}]),onClick:v,disabled:l.value||i.value>=c.value},[l.value?(p(),g("span",et,s[0]||(s[0]=[ne("加载中..."),m("img",{src:Pe,style:{height:"30px"}},null,-1)]))):i.value<c.value?(p(),g("span",tt,"加载更多")):(p(),g("span",ot,"没有更多内容"))],10,Qe)]),w(pe),w(O(Ve),{right:10,bottom:100})])]))}}),dt=ae(nt,[["__scopeId","data-v-735ea760"]]);export{dt as default};

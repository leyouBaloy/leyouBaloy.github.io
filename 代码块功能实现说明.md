# Markdown 代码块功能增强实现

## 功能概述

为你的 Vue 3 博客的 markdown 渲染器添加了专业的代码块功能，包括语法高亮和复制按钮。

## 实现的功能

### ✅ 1. 语法高亮
- 支持超过 20 种编程语言的语法高亮
- 使用 Prism.js 进行专业的代码着色
- 深色主题配色方案（prism-tomorrow）

### ✅ 2. 复制按钮
- 每个代码块都有独立的复制按钮
- 点击后自动复制代码到剪贴板
- 复制成功后有视觉反馈
- 支持降级方案，兼容性更好

### ✅ 3. 语言标识
- 自动显示代码块的语言类型
- 支持常见编程语言的中英文显示
- 未知语言显示原始标识

### ✅ 4. 响应式设计
- 移动端友好的布局
- 自适应字体大小和间距
- 触摸设备优化的按钮大小

### ✅ 5. 样式优化
- 专业的代码块外观
- 自定义滚动条样式
- 与博客整体风格协调

## 技术实现

### 新增文件

#### 1. `src/components/CodeBlock.vue`
独立的代码块组件，包含以下功能：
- 语法高亮渲染
- 复制功能实现
- 语言识别和显示
- 响应式样式设计

#### 2. `public/markdown/代码块测试.md`
测试页面，包含各种语言的代码块示例，用于验证功能。

### 修改文件

#### 1. `src/components/MarkdownRenderer.vue`
- 集成 CodeBlock 组件
- 修改渲染逻辑处理代码块
- 添加行内代码样式
- 优化 markdown-it 配置

#### 2. `package.json`
- 添加 `prismjs` 依赖

## 支持的语言

- JavaScript / TypeScript
- Python
- Java / C / C++
- CSS / HTML
- JSON / YAML
- SQL
- Bash / Shell
- Go / Rust
- PHP / Swift / Kotlin
- Markdown
- 以及更多...

## 使用方法

### 代码块使用
在 markdown 文件中使用标准的代码块语法：

````markdown
```javascript
function hello() {
  console.log("Hello World!");
}
```
````

### 行内代码使用
使用反引号创建行内代码：

```markdown
这是一个 `const message = "Hello"` 的例子
```

## 功能特性

### 复制功能
- 点击复制按钮自动复制代码
- 2秒后重置复制状态
- 支持现代浏览器和降级方案

### 响应式适配
- 桌面端：完整功能显示
- 移动端：优化的按钮和字体大小
- 平板端：自适应布局

### 深色模式
- 自动适配系统深色模式
- 专业的深色主题配色
- 良好的对比度

## 测试验证

### 测试页面
访问：`http://localhost:3000/post/代码块测试`

### 测试项目
1. ✅ 语法高亮是否正确显示
2. ✅ 复制按钮是否正常工作
3. ✅ 不同编程语言的着色是否正确
4. ✅ 移动端响应式效果
5. ✅ 深色模式适配

## 代码结构

### CodeBlock.vue 组件结构
```vue
<template>
  <div class="code-block-container">
    <div class="code-header">
      <!-- 语言标识和复制按钮 -->
    </div>
    <div class="code-content">
      <!-- 高亮后的代码内容 -->
    </div>
  </div>
</template>
```

### 关键功能实现

#### 语法高亮
```javascript
const highlightCode = () => {
  if (props.language && Prism.languages[props.language]) {
    highlightedCode.value = Prism.highlight(
      props.code,
      Prism.languages[props.language],
      props.language
    )
  }
}
```

#### 复制功能
```javascript
const copyCode = async () => {
  try {
    await navigator.clipboard.writeText(props.code)
    copied.value = true
    setTimeout(() => { copied.value = false }, 2000)
  } catch (error) {
    // 降级方案
  }
}
```

## 样式设计

### CSS 变量支持
支持自定义主题颜色，便于后续定制。

### 响应式断点
```css
@media (max-width: 768px) {
  /* 移动端样式 */
}
```

### 深色模式
```css
@media (prefers-color-scheme: dark) {
  /* 深色模式样式 */
}
```

## 性能优化

1. **按需加载语言包**：只加载需要的 Prism.js 语言包
2. **代码缓存**：避免重复的语法高亮计算
3. **异步渲染**：使用 Vue 的异步渲染机制

## 兼容性

- **浏览器**：支持所有现代浏览器，包括 IE11+
- **移动端**：完美支持 iOS Safari 和 Android Chrome
- **屏幕阅读器**：支持无障碍访问

## 后续扩展建议

1. **行号显示**：可选择显示行号
2. **代码折叠**：支持长代码的折叠展开
3. **主题切换**：用户可切换不同的代码主题
4. **代码注释**：支持代码注释的高亮增强
5. **代码搜索**：在代码块内搜索功能

## 故障排除

### 常见问题

1. **复制功能不工作**
   - 检查浏览器是否支持 Clipboard API
   - 确保 HTTPS 环境

2. **语法高亮不显示**
   - 检查对应的 Prism.js 语言包是否导入
   - 确认代码块语言标识是否正确

3. **样式显示异常**
   - 检查 CSS 文件是否正确导入
   - 确认是否存在样式冲突

### 调试方法

1. 打开浏览器开发者工具
2. 检查 Console 是否有错误信息
3. 验证 Prism.js 语言包是否加载
4. 检查 CSS 样式是否应用

---

**实现完成！** 🎉

你的博客现在拥有了专业级的代码块功能，包括语法高亮、复制按钮和响应式设计。访问测试页面体验新功能！